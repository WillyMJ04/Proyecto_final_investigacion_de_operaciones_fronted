<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, width=device-width">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@600&display=swap" />
    <link rel="stylesheet" href="../CSS/Map.css">

    <!-- Incluye la API de Google Maps con Places y tu API Key -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAmT_JUnoisy96sw975ZLhui0fBTOMDwGU&libraries=places"></script>

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* Contenido que se desplazará */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        /* Barra de navegación fija en la parte inferior */
        .navbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 10px 0;
        }

        .navbar img {
            width: 24px;
            height: 24px;
        }

        .navbar div {
            text-align: center;
            font-size: 12px;
        }

        /* Estilo para el mapa */
        #map {
            height: 250px;
            width: 100%;
        }

        /* Espacio inferior para evitar que el contenido se sobreponga a la barra */
        .content-bottom-space {
            height: 70px; /* Altura de la barra de navegación para que el contenido no la tape */
        }

    </style>
</head>
<body>

<!-- Contenido que se desplazará -->
<div class="content">
    <div class="group-parent">
        <div class="group-wrapper">
            <div class="food">
                <img class="food-child" src="../../imgs/Customers/LineOrange.png"/>
                <div class="food-item"></div>
                <div class="profile">
                    <div class="perfil">Perfil</div>
                    <img class="iconlylight-outlineprofile" src="../../imgs/Customers/Profile.png"/>
                </div>
                <div class="inicio-parent">
                    <div class="inicio">Inicio</div>
                    <img class="iconsaxlinearhome2" src="../../imgs/Customers/home2.png"/>
                </div>
                <div class="food-inner"></div>
                <img class="group-icon" src="../../imgs/Customers/send_buttom.png"/>
                <div class="group-container">
                    <div class="chat-wrapper">
                        <div class="chat">Chat</div>
                    </div>
                    <img class="chat-icon" src="../../imgs/Customers/Chat.png"/>
                </div>

                <!-- Campo de búsqueda y lugar para el mapa -->
                <div class="rectangle-container">
                    <div class="rectangle-parent1">
                        <input id="searchInput" class="rectangle-div" type="text" placeholder="Lugar de entrega">
                        <img class="iconsaxlinearsearchnormal11" src="../../imgs/Customers/Lupa.png"/>
                    </div>
                </div>

                <div class="group-parent1" id="groupContainer3">
                    <div class="group-frame">
                        <div class="text-parent">
                            <div class="text"></div>
                            <div class="ubicacion">Ubicacion</div>
                        </div>
                    </div>
                    <img class="basic-location" src="../../imgs/Customers/location.png"/>
                </div>

                <b class="comida">Mapa de entrega</b>

                <!-- Mapa dentro del cuadro gris (group-child1) -->
                <div class="food-inner1">
                    <div class="rectangle-wrapper">
                        <div id="map" class="group-child1"></div>
                    </div>
                </div>

                <div class="instance-parent" id="groupContainer5">
                    <div class="rectangle-wrapper1">
                        <div class="instance-child"></div>
                    </div>
                    <div class="agregar">Agregar</div>
                </div>
            </div>
        </div>
    </div>

    <div class="content-bottom-space"></div> <!-- Espacio para que el contenido no cubra la barra -->
</div>

<!-- Barra de navegación fija -->
<div class="navbar">
    <div>
        <img src="../../imgs/Customers/icon-home.png" alt="Inicio">
        <div>Inicio</div>
    </div>
    <div>
        <img src="../../imgs/Customers/icon-location.png" alt="Ubicación">
        <div>Ubicación</div>
    </div>
    <div>
        <img src="../../imgs/Customers/icon-send.png" alt="Enviar" style="background-color: orange; padding: 10px; border-radius: 50%;">
    </div>
    <div>
        <img src="../../imgs/Customers/icon-chat.png" alt="Chat">
        <div>Chat</div>
    </div>
    <div>
        <img src="../../imgs/Customers/icon-profile.png" alt="Perfil">
        <div>Perfil</div>
    </div>
</div>

<script>
    // Inicializar el mapa y autocompletar
    function initMap() {
        // Crear el mapa dentro del div group-child1
        var map = new google.maps.Map(document.getElementById('map'), {
            center: {lat: -34.397, lng: 150.644}, // Cambia esta ubicación inicial según tus necesidades
            zoom: 13
        });

        // Crear el servicio de autocompletar
        var input = document.getElementById('searchInput');
        var autocomplete = new google.maps.places.Autocomplete(input);

        // Asocia el autocompletado al mapa
        autocomplete.bindTo('bounds', map);

        // InfoWindow para mostrar la dirección seleccionada
        var infowindow = new google.maps.InfoWindow();
        var marker = new google.maps.Marker({
            map: map
        });

        // Evento cuando se selecciona una ubicación de autocompletado
        autocomplete.addListener('place_changed', function() {
            infowindow.close();
            marker.setVisible(false);
            var place = autocomplete.getPlace();

            if (!place.geometry) {
                window.alert("No se encontraron detalles sobre este lugar.");
                return;
            }

            // Si se encuentra el lugar, ajustar el mapa a su ubicación
            if (place.geometry.viewport) {
                map.fitBounds(place.geometry.viewport);
            } else {
                map.setCenter(place.geometry.location);
                map.setZoom(17);  // Zoom más cercano al lugar
            }

            // Marcar la ubicación en el mapa
            marker.setPosition(place.geometry.location);
            marker.setVisible(true);

            // Mostrar la ubicación en una ventana de información
            infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + place.formatted_address);
            infowindow.open(map, marker);
        });
    }

    // Inicializar el mapa cuando el documento esté cargado
    window.onload = initMap;
</script>

</body>
</html>
